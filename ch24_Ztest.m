clear all;

% this section is to use constrainted optimization in chapter17~23 to solve proposed problem
%% 定义函数
X = sym('x',[1,2]);
f = -(X(1)^2+X(2)^2-1)^2-((2*X(1)^2-1)^2+(2*X(2)^2-1)^2-2/3)^2;
c = -(18*X(1)^2 - 18*X(1) - 42*X(1)^4 - 42*X(1)^3 + 17*X(1)^5 + 17*X(1)^6 -3*X(1)*X(2) + 2*X(2) - 8*X(2)^2 - 8*X(2)^3 + 16*X(2)^4 -2);

%% B-SUMT  % cannot solve
X = sym('x',[1,2]);
f = -(X(1)^2+X(2)^2-1)^2-((2*X(1)^2-1)^2+(2*X(2)^2-1)^2-2/3)^2;
c = -(18*X(1)^2 - 18*X(1) - 42*X(1)^4 - 42*X(1)^3 + 17*X(1)^5 + 17*X(1)^6 -3*X(1)*X(2) + 2*X(2) - 8*X(2)^2 - 8*X(2)^3 + 16*X(2)^4 -2);
X_list = ch22_B_SUMT(f, c, [1;1.5], 1e-6); 
x_star = X_list(:,end) 

%% IPM    % cannot solve
X = sym('x',[1,2]);
f = -(X(1)^2+X(2)^2-1)^2-((2*X(1)^2-1)^2+(2*X(2)^2-1)^2-2/3)^2;
c = -(18*X(1)^2 - 18*X(1) - 42*X(1)^4 - 42*X(1)^3 + 17*X(1)^5 + 17*X(1)^6 -3*X(1)*X(2) + 2*X(2) - 8*X(2)^2 - 8*X(2)^3 + 16*X(2)^4 -2);
X_list = ch23_IPM(f, c, [1;1.5], 1e-6);     % 最终收敛到(-1,-1)    
x_star = X_list(:,end)                             